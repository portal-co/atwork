{"mappings":";;;AAGO,UAAU,0CACf,IAAkB,EAClB,UACE,SAAS,oBACT,SAAS,OAAO,MAAM,IAAI,EAAE,EAClB,GAAG,CAAC,CAAC;IAEjB,KAAK,MAAM,KAAK,OAAQ;QACtB,MAAM,MAAM,EAAE,QAAQ,CAAC,CAAA,GAAA,yBAAiB,EAAE,OAAO,CAAC,SAAS;QAC3D,MAAM,MAAM,EAAE,QAAQ,CAAC,GAAG,CAAA,GAAA,yBAAiB,EAAE,OAAO,CAAC,SAAS;QAC9D,GAAG,KAAK,MAAM,KAAK,KACjB,IAAI,CAAA,GAAA,yBAAiB,EAAE,MAAM,CAAC,KAAK,KAAK,IAAI;YAC1C,MAAM,UAAU,IAAI,cAAc,MAAM,CAAC;YACzC,IAAI,WAAW,QAAQ,MAAM,MAAM,CAAC,QAAQ;YAC5C,MAAM;QACR;IAEJ;AACF;AACO,SAAS,0CACd,OAAmB,EACnB,QAAsB,EACtB,UACE,SAAS,oBACT,SAAU,OAAO,MAAM,KAAK,EAAE,kBAC9B,iBAAiB,OAAO,cAAc,EAGvC,GAAG,CAAC,CAAC;IAEN,MAAM,MAAM,QAAQ,QAAQ,CAAC,CAAA,GAAA,yBAAiB,EAAE,OAAO,CAAC,SAAS;IACjE,OAAO,IAAI,CAAC;IACZ,MAAM,UAAU,IAAI,cAAc,MAAM,CAAC;IACzC,eAAe,QAAQ,SAAS;QAC9B,OAAO;QACP,UAAU;QACV,YAAY;QACZ,cAAc;IAChB;AACF","sources":["js/index.ts"],"sourcesContent":["import { slh_dsa_shake_256s } from \"@noble/post-quantum/slh-dsa.js\";\nexport interface WorkProvider {}\nexport type AtWorkCtx = { window?: any; atwork?: Uint8Array[] };\nexport function* crawl(\n  keys: Uint8Array[],\n  {\n    window = globalThis,\n    atwork = window.atwork ?? [],\n  }: AtWorkCtx = {}\n): Generator<WorkProvider, void, void> {\n  for (const w of atwork) {\n    const msg = w.subarray(slh_dsa_shake_256s.lengths.signature);\n    const sig = w.subarray(0, slh_dsa_shake_256s.lengths.signature);\n    a: for (const k of keys) {\n      if (slh_dsa_shake_256s.verify(sig, msg, k)) {\n        const decoded = new TextDecoder().decode(msg);\n        if (decoded in window) yield window[decoded];\n        break a;\n      }\n    }\n  }\n}\nexport function inject(\n  payload: Uint8Array,\n  provider: WorkProvider,\n  {\n    window = globalThis,\n    atwork = (window.atwork ??= []),\n    defineProperty = Object.defineProperty,\n  }: AtWorkCtx & {\n    defineProperty?: typeof Object.defineProperty;\n  } = {}\n) {\n  const msg = payload.subarray(slh_dsa_shake_256s.lengths.signature);\n  atwork.push(payload);\n  const decoded = new TextDecoder().decode(msg);\n  defineProperty(window, decoded, {\n    value: provider,\n    writable: false,\n    enumerable: false,\n    configurable: false,\n  });\n}\n"],"names":[],"version":3,"file":"index.js.map"}